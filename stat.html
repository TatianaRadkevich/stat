<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Statistic</title>
    <script type="text/javascript" src="jquery-3.1.1.min.js"></script>
    <script type="text/javascript" src="//cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="bootstrap.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.0/Chart.bundle.min.js"></script>
    <link href="//cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css" rel="stylesheet">
    <link href="bootstrap.css" rel="stylesheet">
</head>
<body>
<div class="container">
    <table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%">
        <thead>
        <tr>
            <th>Name</th>
            <th>Position</th>
            <th>Office</th>
            <th>Age</th>
            <th>Start date</th>
            <th>Salary</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>Tiger Nixon</td>
            <td>System Architect</td>
            <td>Edinburgh</td>
            <td>61</td>
            <td>2011/04/25</td>
            <td>$320,800</td>
        </tr>
        <tr>
            <td>Garrett Winters</td>
            <td>Accountant</td>
            <td>Tokyo</td>
            <td>63</td>
            <td>2011/07/25</td>
            <td>$170,750</td>
        </tr>
        <tr>
            <td>Ashton Cox</td>
            <td>Junior Technical Author</td>
            <td>San Francisco</td>
            <td>66</td>
            <td>2009/01/12</td>
            <td>$86,000</td>
        </tr>
        <tr>
            <td>Cedric Kelly</td>
            <td>Senior Javascript Developer</td>
            <td>Edinburgh</td>
            <td>22</td>
            <td>2012/03/29</td>
            <td>$433,060</td>
        </tr>
        <tr>
            <td>Airi Satou</td>
            <td>Accountant</td>
            <td>Tokyo</td>
            <td>33</td>
            <td>2008/11/28</td>
            <td>$162,700</td>
        </tr>
        <tr>
            <td>Brielle Williamson</td>
            <td>Integration Specialist</td>
            <td>New York</td>
            <td>61</td>
            <td>2012/12/02</td>
            <td>$372,000</td>
        </tr>
        <tr>
            <td>Herrod Chandler</td>
            <td>Sales Assistant</td>
            <td>San Francisco</td>
            <td>59</td>
            <td>2012/08/06</td>
            <td>$137,500</td>
        </tr>
        <tr>
            <td>Rhona Davidson</td>
            <td>Integration Specialist</td>
            <td>Tokyo</td>
            <td>55</td>
            <td>2010/10/14</td>
            <td>$327,900</td>
        </tr>
        <tr>
            <td>Colleen Hurst</td>
            <td>Javascript Developer</td>
            <td>San Francisco</td>
            <td>39</td>
            <td>2009/09/15</td>
            <td>$205,500</td>
        </tr>
        <tr>
            <td>Sonya Frost</td>
            <td>Software Engineer</td>
            <td>Edinburgh</td>
            <td>23</td>
            <td>2008/12/13</td>
            <td>$103,600</td>
        </tr>
        <tr>
            <td>Jena Gaines</td>
            <td>Office Manager</td>
            <td>London</td>
            <td>30</td>
            <td>2008/12/19</td>
            <td>$90,560</td>
        </tr>
        <tr>
            <td>Quinn Flynn</td>
            <td>Support Lead</td>
            <td>Edinburgh</td>
            <td>22</td>
            <td>2013/03/03</td>
            <td>$342,000</td>
        </tr>
        <tr>
            <td>Charde Marshall</td>
            <td>Regional Director</td>
            <td>San Francisco</td>
            <td>36</td>
            <td>2008/10/16</td>
            <td>$470,600</td>
        </tr>
        <tr>
            <td>Haley Kennedy</td>
            <td>Senior Marketing Designer</td>
            <td>London</td>
            <td>43</td>
            <td>2012/12/18</td>
            <td>$313,500</td>
        </tr>
        <tr>
            <td>Tatyana Fitzpatrick</td>
            <td>Regional Director</td>
            <td>London</td>
            <td>19</td>
            <td>2010/03/17</td>
            <td>$385,750</td>
        </tr>
        <tr>
            <td>Michael Silva</td>
            <td>Marketing Designer</td>
            <td>London</td>
            <td>66</td>
            <td>2012/11/27</td>
            <td>$198,500</td>
        </tr>
        <tr>
            <td>Paul Byrd</td>
            <td>Chief Financial Officer (CFO)</td>
            <td>New York</td>
            <td>64</td>
            <td>2010/06/09</td>
            <td>$725,000</td>
        </tr>
        <tr>
            <td>Gloria Little</td>
            <td>Systems Administrator</td>
            <td>New York</td>
            <td>59</td>
            <td>2009/04/10</td>
            <td>$237,500</td>
        </tr>
        <tr>
            <td>Bradley Greer</td>
            <td>Software Engineer</td>
            <td>London</td>
            <td>41</td>
            <td>2012/10/13</td>
            <td>$132,000</td>
        </tr>
        <tr>
            <td>Dai Rios</td>
            <td>Personnel Lead</td>
            <td>Edinburgh</td>
            <td>35</td>
            <td>2012/09/26</td>
            <td>$217,500</td>
        </tr>
        <tr>
            <td>Jenette Caldwell</td>
            <td>Development Lead</td>
            <td>New York</td>
            <td>30</td>
            <td>2011/09/03</td>
            <td>$345,000</td>
        </tr>
        <tr>
            <td>Yuri Berry</td>
            <td>Chief Marketing Officer (CMO)</td>
            <td>New York</td>
            <td>40</td>
            <td>2009/06/25</td>
            <td>$675,000</td>
        </tr>
        <tr>
            <td>Caesar Vance</td>
            <td>Pre-Sales Support</td>
            <td>New York</td>
            <td>21</td>
            <td>2011/12/12</td>
            <td>$106,450</td>
        </tr>
        <tr>
            <td>Doris Wilder</td>
            <td>Sales Assistant</td>
            <td>Sidney</td>
            <td>23</td>
            <td>2010/09/20</td>
            <td>$85,600</td>
        </tr>
        <tr>
            <td>Angelica Ramos</td>
            <td>Chief Executive Officer (CEO)</td>
            <td>London</td>
            <td>47</td>
            <td>2009/10/09</td>
            <td>$1,200,000</td>
        </tr>
        <tr>
            <td>Gavin Joyce</td>
            <td>Developer</td>
            <td>Edinburgh</td>
            <td>42</td>
            <td>2010/12/22</td>
            <td>$92,575</td>
        </tr>
        <tr>
            <td>Jennifer Chang</td>
            <td>Regional Director</td>
            <td>Singapore</td>
            <td>28</td>
            <td>2010/11/14</td>
            <td>$357,650</td>
        </tr>
        <tr>
            <td>Brenden Wagner</td>
            <td>Software Engineer</td>
            <td>San Francisco</td>
            <td>28</td>
            <td>2011/06/07</td>
            <td>$206,850</td>
        </tr>
        <tr>
            <td>Fiona Green</td>
            <td>Chief Operating Officer (COO)</td>
            <td>San Francisco</td>
            <td>48</td>
            <td>2010/03/11</td>
            <td>$850,000</td>
        </tr>
        <tr>
            <td>Shou Itou</td>
            <td>Regional Marketing</td>
            <td>Tokyo</td>
            <td>20</td>
            <td>2011/08/14</td>
            <td>$163,000</td>
        </tr>
        <tr>
            <td>Michelle House</td>
            <td>Integration Specialist</td>
            <td>Sidney</td>
            <td>37</td>
            <td>2011/06/02</td>
            <td>$95,400</td>
        </tr>
        <tr>
            <td>Suki Burks</td>
            <td>Developer</td>
            <td>London</td>
            <td>53</td>
            <td>2009/10/22</td>
            <td>$114,500</td>
        </tr>
        <tr>
            <td>Prescott Bartlett</td>
            <td>Technical Author</td>
            <td>London</td>
            <td>27</td>
            <td>2011/05/07</td>
            <td>$145,000</td>
        </tr>
        <tr>
            <td>Gavin Cortez</td>
            <td>Team Leader</td>
            <td>San Francisco</td>
            <td>22</td>
            <td>2008/10/26</td>
            <td>$235,500</td>
        </tr>
        <tr>
            <td>Martena Mccray</td>
            <td>Post-Sales support</td>
            <td>Edinburgh</td>
            <td>46</td>
            <td>2011/03/09</td>
            <td>$324,050</td>
        </tr>
        <tr>
            <td>Unity Butler</td>
            <td>Marketing Designer</td>
            <td>San Francisco</td>
            <td>47</td>
            <td>2009/12/09</td>
            <td>$85,675</td>
        </tr>
        <tr>
            <td>Howard Hatfield</td>
            <td>Office Manager</td>
            <td>San Francisco</td>
            <td>51</td>
            <td>2008/12/16</td>
            <td>$164,500</td>
        </tr>
        <tr>
            <td>Hope Fuentes</td>
            <td>Secretary</td>
            <td>San Francisco</td>
            <td>41</td>
            <td>2010/02/12</td>
            <td>$109,850</td>
        </tr>
        <tr>
            <td>Vivian Harrell</td>
            <td>Financial Controller</td>
            <td>San Francisco</td>
            <td>62</td>
            <td>2009/02/14</td>
            <td>$452,500</td>
        </tr>
        <tr>
            <td>Timothy Mooney</td>
            <td>Office Manager</td>
            <td>London</td>
            <td>37</td>
            <td>2008/12/11</td>
            <td>$136,200</td>
        </tr>
        <tr>
            <td>Jackson Bradshaw</td>
            <td>Director</td>
            <td>New York</td>
            <td>65</td>
            <td>2008/09/26</td>
            <td>$645,750</td>
        </tr>
        <tr>
            <td>Olivia Liang</td>
            <td>Support Engineer</td>
            <td>Singapore</td>
            <td>64</td>
            <td>2011/02/03</td>
            <td>$234,500</td>
        </tr>
        <tr>
            <td>Bruno Nash</td>
            <td>Software Engineer</td>
            <td>London</td>
            <td>38</td>
            <td>2011/05/03</td>
            <td>$163,500</td>
        </tr>
        <tr>
            <td>Sakura Yamamoto</td>
            <td>Support Engineer</td>
            <td>Tokyo</td>
            <td>37</td>
            <td>2009/08/19</td>
            <td>$139,575</td>
        </tr>
        <tr>
            <td>Thor Walton</td>
            <td>Developer</td>
            <td>New York</td>
            <td>61</td>
            <td>2013/08/11</td>
            <td>$98,540</td>
        </tr>
        <tr>
            <td>Finn Camacho</td>
            <td>Support Engineer</td>
            <td>San Francisco</td>
            <td>47</td>
            <td>2009/07/07</td>
            <td>$87,500</td>
        </tr>
        <tr>
            <td>Serge Baldwin</td>
            <td>Data Coordinator</td>
            <td>Singapore</td>
            <td>64</td>
            <td>2012/04/09</td>
            <td>$138,575</td>
        </tr>
        <tr>
            <td>Zenaida Frank</td>
            <td>Software Engineer</td>
            <td>New York</td>
            <td>63</td>
            <td>2010/01/04</td>
            <td>$125,250</td>
        </tr>
        <tr>
            <td>Zorita Serrano</td>
            <td>Software Engineer</td>
            <td>San Francisco</td>
            <td>56</td>
            <td>2012/06/01</td>
            <td>$115,000</td>
        </tr>
        </tbody>
    </table>
</div>
<div class="container">
    <canvas id="myChart"></canvas>
</div>
</body>
<script>
    $(document).ready(function () {
        var colors = [
            'rgba(128,0,0, 1)',
            'rgba(139,0,0, 1)',
            'rgba(165,42,42, 1)',
            'rgba(178,34,34, 1)',
            'rgba(220,20,60, 1)',
            'rgba(255,0,0, 1)',
            'rgba(255,99,71, 1)',
            'rgba(255,127,80, 1)',
            'rgba(205,92,92, 1)',
            'rgba(240,128,128, 1)',
            'rgba(233,150,122, 1)',
            'rgba(250,128,114, 1)',
            'rgba(255,160,122, 1)',
            'rgba(255,69,0, 1)',
            'rgba(255,140,0, 1)',
            'rgba(255,165,0, 1)',
            'rgba(255,215,0, 1)',
            'rgba(184,134,11, 1)',
            'rgba(218,165,32, 1)',
            'rgba(238,232,170, 1)',
            'rgba(189,183,107, 1)',
            'rgba(240,230,140, 1)',
            'rgba(128,128,0, 1)',
            'rgba(255,255,0, 1)',
            'rgba(154,205,50, 1)',
            'rgba(85,107,47, 1)',
            'rgba(107,142,35, 1)',
            'rgba(124,252,0, 1)',
            'rgba(127,255,0, 1)',
            'rgba(173,255,47, 1)',
            'rgba(0,100,0, 1)',
            'rgba(0,128,0, 1)',
            'rgba(34,139,34, 1)',
            'rgba(0,255,0, 1)',
            'rgba(50,205,50, 1)',
            'rgba(144,238,144, 1)',
            'rgba(152,251,152, 1)',
            'rgba(143,188,143, 1)',
            'rgba(0,250,154, 1)',
            'rgba(0,255,127, 1)',
            'rgba(46,139,87, 1)',
            'rgba(102,205,170, 1)',
            'rgba(60,179,113, 1)',
            'rgba(32,178,170, 1)',
            'rgba(47,79,79, 1)',
            'rgba(0,128,128, 1)',
            'rgba(0,139,139, 1)',
            'rgba(0,255,255, 1)',
            'rgba(224,255,255, 1)',
            'rgba(0,206,209, 1)',
            'rgba(64,224,208, 1)',
            'rgba(72,209,204, 1)',
            'rgba(175,238,238, 1)',
            'rgba(127,255,212, 1)',
            'rgba(176,224,230, 1)',
            'rgba(95,158,160, 1)',
            'rgba(70,130,180, 1)',
            'rgba(100,149,237, 1)',
            'rgba(0,191,255, 1)',
            'rgba(30,144,255, 1)',
            'rgba(173,216,230, 1)',
            'rgba(135,206,235, 1)',
            'rgba(135,206,250, 1)',
            'rgba(25,25,112, 1)',
            'rgba(0,0,128, 1)',
            'rgba(0,0,139, 1)',
            'rgba(0,0,205, 1)',
            'rgba(0,0,255, 1)',
            'rgba(65,105,225, 1)',
            'rgba(138,43,226, 1)',
            'rgba(75,0,130, 1)',
            'rgba(72,61,139, 1)',
            'rgba(106,90,205, 1)',
            'rgba(123,104,238, 1)',
            'rgba(147,112,219, 1)',
            'rgba(139,0,139, 1)',
            'rgba(148,0,211, 1)',
            'rgba(153,50,204, 1)',
            'rgba(186,85,211, 1)',
            'rgba(128,0,128, 1)',
            'rgba(216,191,216, 1)',
            'rgba(221,160,221, 1)',
            'rgba(238,130,238, 1)',
            'rgba(255,0,255, 1)',
            'rgba(218,112,214, 1)',
            'rgba(199,21,133, 1)',
            'rgba(219,112,147, 1)',
            'rgba(255,20,147, 1)',
            'rgba(255,105,180, 1)',
            'rgba(255,182,193, 1)',
            'rgba(255,192,203, 1)',
            'rgba(250,235,215, 1)',
            'rgba(245,245,220, 1)',
            'rgba(255,228,196, 1)',
            'rgba(255,235,205, 1)',
            'rgba(245,222,179, 1)',
            'rgba(255,248,220, 1)',
            'rgba(255,250,205, 1)',
            'rgba(250,250,210, 1)',
            'rgba(255,255,224, 1)',
            'rgba(139,69,19, 1)',
            'rgba(160,82,45, 1)',
            'rgba(210,105,30, 1)',
            'rgba(205,133,63, 1)',
            'rgba(244,164,96, 1)',
            'rgba(222,184,135, 1)',
            'rgba(210,180,140, 1)',
            'rgba(188,143,143, 1)',
            'rgba(255,228,181, 1)',
            'rgba(255,222,173, 1)',
            'rgba(255,218,185, 1)',
            'rgba(255,228,225, 1)',
            'rgba(255,240,245, 1)',
            'rgba(250,240,230, 1)',
            'rgba(253,245,230, 1)',
            'rgba(255,239,213, 1)',
            'rgba(255,245,238, 1)',
            'rgba(245,255,250, 1)',
            'rgba(112,128,144, 1)',
            'rgba(119,136,153, 1)',
            'rgba(176,196,222, 1)',
            'rgba(230,230,250, 1)',
            'rgba(255,250,240, 1)',
            'rgba(240,248,255, 1)',
            'rgba(248,248,255, 1)',
            'rgba(240,255,240, 1)',
            'rgba(255,255,240, 1)',
            'rgba(240,255,255, 1)',
            'rgba(255,250,250, 1)',
            'rgba(0,0,0, 1)',
            'rgba(105,105,105, 1)',
            'rgba(128,128,128, 1)',
            'rgba(169,169,169, 1)',
            'rgba(192,192,192, 1)',
            'rgba(211,211,211, 1)',
            'rgba(220,220,220, 1)',
            'rgba(245,245,245, 1)',
            'rgba(255,255,255, 1)'
        ];

        shuffle(colors);

        var filteredData,
            table = $("#example"),
            filteredPositions;

        table.DataTable({
                "language": {
                    "url": "Russian.json"
                }
            }
        );

        var filterData = function () {
            var positionsNames = [],
                positionsCounter = [],
                colorsCounter = [];
            filteredData = $("#example").DataTable().rows({filter: 'applied'}).data();
            filteredPositions = getPositions();
            colorsCounter = colors.slice(0, filteredPositions.length);
            var counter = positions();
            getUniquePositions(filteredPositions).forEach(function (item, i, pos) {
                positionsNames[i] = item;
                positionsCounter[i] = counter[item];
            });

            myChart.config.data = {
                datasets: [{
                    data: positionsCounter,
                    backgroundColor: colorsCounter
                }],
                labels: positionsNames
            };
            myChart.update();
        };

        var positions = function () {
            var posArray = getPositions(),
                counts = [];
            for (var i = 0; i < posArray.length; i++) {
                counts[posArray[i]] = 1 + (counts[posArray[i]] || 0);
            }
            return counts;
        };

        var getPositions = function () {
            var posArray = [];
            for (var i = 0; i < filteredData.length; i++) {
                posArray[i] = filteredData[i][1];
            }
            return posArray;
        };

        var getUniquePositions = function (arr) {
            return arr.unique();
        };

        table.on('search.dt', function () {
            filterData();
        });

        Array.prototype.contains = function (v) {
            for (var i = 0; i < this.length; i++) {
                if (this[i] === v) return true;
            }
            return false;
        };

        Array.prototype.unique = function () {
            var arr = [];
            for (var i = 0; i < this.length; i++) {
                if (!arr.contains(this[i])) {
                    arr.push(this[i]);
                }
            }
            return arr;
        };

        var data = {
            datasets: [{
                data: [],
                backgroundColor: []
            }],
            labels: []
        };

        var ctx = document.getElementById("myChart");
        var myChart = new Chart(ctx, {
            type: 'doughnut',
            data: data,
            options: {}
        });

        function shuffle(a) {
            var j, x, i;
            for (i = a.length; i; i--) {
                j = Math.floor(Math.random() * i);
                x = a[i - 1];
                a[i - 1] = a[j];
                a[j] = x;
            }
        }
    });
</script>
</html>